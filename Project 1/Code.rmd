---
title: "Big Data Proj 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(igraph)
```

```{r cars}
setwd("~/Documents/development/CSCI_3907/Project 1/")

read_project_files <- function(data_path){
  ego_networks <- lapply(list.files(path=data_path, pattern = '*.edges'), function(edgelist){
    read.table(paste(data_path, edgelist, sep=''))
  })
  return(ego_networks)
}

graphs <- read_project_files('~/Documents/development/CSCI_3907/Project 1/data/facebook/')

```

```{r}
parseMainGraph <- function(graphs){
  combined_graph <- data.frame()
  
  for (el in graphs){
    combined_graph <- rbind(combined_graph, el)
  }
  
  cg <- graph_from_data_frame(combined_graph, directed = FALSE)
  
  simplified_graph <- simplify(cg)
  
  hist(degree(simplified_graph))
  
  E(simplified_graph)[degree(simplified_graph) < 200]
  
  betweenness(simplified_graph)
  
  eigen_centrality(simplified_graph)
  
  diameter(simplified_graph)
  
  get_diameter(simplified_graph)
  
  plot(simplified_graph)
  
  plot(simplified_graph, layout.reingold.tilford(simplified_graph, circular=T)) 
}

parseMainGraph(graphs)
```

### Process individual sub graph:
```{r}
processGraph <- function(gr){
  if(class(gr) != 'igraph') {
    gr = graph_from_data_frame(gr, directed=FALSE)
  }
  #Plot the graph:
  plot(gr, layout=layout_with_fr(gr, niter=1000))
  #Largest Clique
  largest_cliques(gr)
  #Find Ego
  ego(gr, 2)
  #Power Centrality
  alpha_centrality(gr)
}


for (graph in graphs){
  processGraph(graph)
}
```